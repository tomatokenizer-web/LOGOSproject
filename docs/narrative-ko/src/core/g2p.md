# 자소-음소 변환 (G2P) 분석 모듈

> **최종 업데이트**: 2026-01-04
> **코드 위치**: `src/core/g2p.ts`
> **상태**: 활성

---

## 맥락 및 목적

이 모듈은 언어 학습의 근본적인 도전을 해결하기 위해 존재합니다: 영어 철자는 발음과 일관성이 없기로 악명 높습니다. "through," "though," "tough," "thought"와 같은 단어들은 모두 "ough"를 포함하지만 다르게 발음합니다. 언어 학습자에게 이것은 상당한 혼란과 발음 오류를 만듭니다.

G2P 모듈은 단어가 철자되는 방식(자소)과 발음되는 방식(음소) 사이의 관계를 분석하여 LOGOS가 다음을 할 수 있게 합니다:

1. **발음 난이도 예측** - 학습자에게 단어를 제시하기 전에
2. **특정 오류 예상** - 학습자의 모국어를 기반으로
3. **학습 전이 측정** - 철자 패턴이 숙달되었을 때

**비즈니스 필요성**: 언어 학습자들은 예측 불가능한 철자-발음 관계를 가진 단어를 적절한 지원 없이 받으면 시간을 낭비하고 화석화된 발음 오류를 발달시킵니다. G2P 패턴을 분석함으로써 LOGOS는 발음 교육을 스캐폴딩하고, 최적의 순서로 단어를 제시하며, 대상화된 피드백을 제공할 수 있습니다.

**사용 시점**:
- 어휘 과제 생성 중 단어 난이도 추정
- LanguageObjectVector 음운적 및 철자적 차원 계산 시
- 특정 학습자가 어떤 오류를 범할지 예측할 때
- 하나의 철자 패턴 숙달이 유사한 패턴 학습에 도움이 되는지 측정할 때

---

## 미시적 관점: 직접적 관계

### 의존성 (이 모듈이 필요로 하는 것)

이 모듈은 외부 의존성이 없이 의도적으로 자체 완결형입니다. 다음을 구현합니다:
- 모든 분석을 위한 순수 TypeScript
- G2P 규칙을 위한 정규식 기반 패턴 매칭
- 음절 수 세기 및 강세 추정을 위한 휴리스틱 알고리즘

**설계 근거**: 외부 음소 사전 (CMU Pronouncing Dictionary 같은)을 피함으로써 모듈은 가볍게 유지되고 오프라인으로 작동합니다. 트레이드오프는 불규칙 단어에 대한 정확도 감소이며, 이는 난이도 추정 목적으로는 수용 가능합니다.

### 종속자 (이 모듈을 필요로 하는 것)

- `src/core/languageObjectVector.ts`: 어휘 항목의 음운적 및 철자적 차원을 채우기 위해 `toPhonologicalVector()` 및 `toOrthographicVector()` 호출
- `src/scheduling/taskCalibration.ts`: 스케줄러를 위한 발음 과제 난이도 추정에 `analyzeG2PDifficulty()` 사용
- `src/learning/pronunciationTraining.ts`: L1 특정 발음 피드백 생성에 `predictMispronunciations()` 사용
- `src/analytics/transferEffects.ts`: G2P 훈련이 어휘 습득에 미치는 영향 추적에 `findG2PTransferCandidates()` 및 `measureG2PTransfer()` 사용

### 데이터 흐름

```
단어 입력
    |
    v
analyzeG2PDifficulty() --> ENGLISH_G2P_RULES에 대해 확인
    |                           |
    |                           v
    |                   예외 단어 식별
    |                   묵음 문자 탐지
    |                   모음 이중음자 찾기
    |                   자음군 수 세기
    |
    v
G2PDifficulty 결과
    |
    +--> difficultyScore (0-1) --> 과제 보정
    +--> irregularPatterns --> 진단 UI
    +--> syllableCount --> 음운적 벡터
    |
    v
L1 제공 시: analyzeG2PWithL1()
    |
    v
L1Mispronunciation 예측 --> 발음 피드백
```

---

## 거시적 관점: 시스템 통합

### 아키텍처 계층

이 모듈은 LOGOS 아키텍처의 **핵심 분석 계층**에 위치합니다:

```
계층 1: 사용자 인터페이스 (발음 연습, 피드백 표시)
    |
계층 2: 학습 엔진 (과제 선택, 피드백 생성)
    |
계층 3: 핵심 분석 <-- G2P 모듈이 여기 있음
    |       - 어휘 항목의 언어학적 속성 분석
    |       - 난이도 지표 계산
    |       - 지식 표현을 위한 벡터 생성
    |
계층 4: 데이터 계층 (어휘 데이터베이스, 학습자 프로필)
```

### 전체적 영향

G2P 모듈은 세 가지 주요 LOGOS 기능을 가능하게 합니다:

**1. 지능적 과제 순서화**
G2P 분석 없이 LOGOS는 임의의 순서로 단어를 제시할 것입니다. 이것이 있으면 시스템은 규칙적인 (예측 가능한 철자) 것에서 불규칙적인 것으로 단어를 순서화하여 학습자가 예외를 만나기 전에 패턴 인식을 구축하도록 보장합니다.

**2. 개인화된 오류 예측**
영어를 배우는 스페인어 화자는 중국어 화자와 다른 발음 오류를 범합니다. L1 간섭 데이터베이스는 LOGOS가 오류가 발생하기 전에 예상하고 선제적 교육을 제공할 수 있게 합니다.

**3. 전이 효과 측정**
학습자가 "-tion" 접미사 패턴 (nation, station, operation)을 숙달하면 새로운 "-tion" 단어를 더 빨리 배우는가? 전이 효과 함수는 이를 측정하여 LOGOS가 어떤 패턴을 명시적으로 가르칠지 대 학습자가 자연스럽게 발견하게 할지 최적화할 수 있게 합니다.

### 임계 경로 분석

**중요도 수준**: 높음 (발음 영역)

- **실패 시**: 발음 과제 난이도 추정이 단순한 휴리스틱 (단어 길이, 빈도)으로 대체됨. L1 특정 피드백 사용 불가. 전이 효과 추적 비활성화.

- **우아한 성능 저하**: 패턴이 발견되지 않으면 모듈은 합리적인 기본값 반환. 알 수 없는 단어도 음절 수와 기본 분석을 받음.

- **단일 실패 지점 없음**: 다른 LOGOS 구성요소는 G2P 분석 없이도 기능할 수 있지만, 발음 관련 기능은 상당히 저하됨.

---

## 기술적 개념 (쉬운 설명)

### 자소-음소 대응 (G2P)
**기술적**: 규칙, 맥락, 예외를 포함한 서면 문자 시퀀스 (자소)와 그 발화된 소리 표현 (음소) 사이의 체계적 매핑.

**쉬운 설명**: 철자를 기반으로 단어를 어떻게 발음하는지 알려주는 규칙. 스페인어에서는 이 규칙이 거의 완벽합니다 - "a"는 항상 "아"처럼 발음됩니다. 영어에서는 이 규칙이 예외로 가득합니다 - "ough"는 "oo" (through), "oh" (though), "uff" (tough), 또는 "aw" (thought)처럼 발음될 수 있습니다.

**사용 이유**: 이러한 규칙과 예외를 목록화함으로써 어떤 단어가 발음하기 어려울지와 그 이유를 예측할 수 있습니다.

### L1 간섭 (부정적 전이)
**기술적**: 학습자의 모국어 (L1)에서 온 음운 패턴이 목표 언어 (L2) 발음을 방해하여 대조 분석에서 예측 가능한 체계적 오류 패턴을 일으키는 것.

**쉬운 설명**: 모국어가 새 언어를 발음하는 "방해"가 될 때. 스페인어에는 "sp-"로 시작하는 단어가 없어서 스페인어 화자는 본능적으로 그 앞에 "에" 소리를 추가하여 "spanish" 대신 "에스패니시"라고 말합니다. 무작위가 아닙니다 - 모국어에 어떤 소리가 있는지에 따라 예측 가능합니다.

**사용 이유**: 학습자의 모국어를 알면 어떤 영어 소리가 어려울지 정확히 예측하고 대상화된 연습을 제공할 수 있습니다.

### 음운적 벡터
**기술적**: 음소 시퀀스, 음절 구조, 강세 패턴, 음절 수를 포함한 단어의 소리 속성의 다차원 표현으로, 머신러닝 모델의 입력 특성으로 사용됨.

**쉬운 설명**: 단어가 어떻게 들리는지의 수치적 "지문"으로, 다음을 포착합니다: 음절이 몇 개인가? 어떤 음절에 강세가 있는가? 자음과 모음의 패턴이 무엇인가? 이 지문은 컴퓨터가 실제로 아무것도 "듣지" 않아도 두 단어가 얼마나 유사하게 들리는지 비교할 수 있게 합니다.

**사용 이유**: LanguageObjectVector는 어휘 항목을 완전히 표현하기 위해 음운 정보가 필요합니다. 이 벡터가 그 차원을 제공합니다.

### 전이 효과 (긍정적 전이)
**기술적**: 이전에 숙달한 항목과 구조적 패턴을 공유하는 새 항목의 습득 속도 개선으로, 명시적 패턴 교육 전후의 학습 곡선 차이로 계산됨.

**쉬운 설명**: 한 가지를 배우면 유사한 것들을 더 쉽게 배우는 것. "nation"에서 "-tion" 어미를 숙달하면 뇌가 이미 그 패턴을 파악했기 때문에 "station," "vacation," "education"을 더 빨리 배웁니다. 우리는 전후의 학습 속도를 비교하여 이를 측정합니다.

**사용 이유**: 전이를 측정함으로써 LOGOS는 명시적으로 가르칠 가치가 있는 고가치 패턴 대 학습자가 자연스럽게 습득하는 패턴을 식별할 수 있습니다.

### 묵음 문자
**기술적**: 단어의 철자 표현에는 나타나지만 발음에서 대응하는 음소가 없는 자소로, 종종 이전 발음이나 차용된 철자의 역사적 잔재.

**쉬운 설명**: 쓰지만 말하지 않는 문자. "knife"의 "k", "climb"의 "b", "night"의 "gh". 보통 영어가 수세기 전에 실제로 그 문자들을 발음했던 것의 잔재이지만, 철자는 그대로 유지되면서 발음이 바뀌었습니다.

**사용 이유**: 묵음 문자는 발음 난이도의 주요 원인입니다. 이를 탐지하면 학습자에게 경고하고 특별한 교육을 제공할 수 있습니다.

### 모음 이중음자
**기술적**: 단어 기원과 맥락에 따라 가변적인 발음을 가지는, 단일 음소나 이중모음을 나타내는 두 모음 자소의 시퀀스.

**쉬운 설명**: 한 소리를 만들기 위해 팀을 이루는 두 모음. "beat"의 "EA"는 긴 "이" 소리를 만듭니다. 하지만 "bread"의 "EA"는 짧은 "에" 소리를 만듭니다. 이러한 조합은 항상 일관적이지 않아서 까다롭습니다.

**사용 이유**: 모음 조합은 영어에서 예측 불가능하며 G2P 난이도 점수에 상당히 기여합니다.

---

## 주요 데이터 구조

### ENGLISH_G2P_RULES 데이터베이스

모듈에는 범주별로 구성된 40개 이상의 G2P 규칙이 있습니다:

| 범주 | 예시 패턴 | 음소 | 신뢰도 | 참고 |
|----------|-----------------|---------|-------------|-------|
| 마법의 E | `a[^aeiou]e$` | /ei/ | 85% | "make"는 맞지만 "have"는 아님 |
| 모음 이중음자 | `ee` | /i:/ | 95% | 매우 신뢰할 수 있음 |
| 모음 이중음자 | `ea` | /i:/ | 70% | 많은 예외 |
| R-통제 | `ar` | /a:r/ | 85% | "car"는 맞지만 "war"는 아님 |
| 묵음 자음 | `^kn` | /n/ | 99% | 항상 묵음 k |
| 자음 이중음자 | `ph` | /f/ | 99% | 그리스어에서 |
| 연음 C | `c[eiy]` | /s/ | 95% | "city," "cent" |
| 접미사 | `-tion` | /shun/ | 95% | 매우 신뢰할 수 있음 |
| 의학 | `^psych` | /saik/ | 99% | 도메인 특정 |

**신뢰도 점수**: 규칙이 얼마나 일관되게 적용되는지를 나타냅니다. 낮은 신뢰도 ("ou"는 50%)는 많은 예외가 존재함을 의미합니다.

### L1_INTERFERENCE_PATTERNS 데이터베이스

여섯 가지 모국어 배경을 지원합니다:

| L1 | 주요 간섭 패턴 | 일반 패턴 |
|----|---------------------------|------------------|
| 스페인어 | sp-에 /esp-/, v에 /b/, /th/ 없음 | 모음 축약 어려움 |
| 포르투갈어 | th에 /t/ 또는 /f/, 묵음 h | 비음화 전이 |
| 중국어 | 근사음 r, v에 /w/, /th/ 없음 | 종성 자음 탈락 |
| 일본어 | r/l 합병, v에 /b/, f에 /h/ | 자음군에 모음 삽입 |
| 한국어 | f에 /p/, v에 /b/, r/l 이음 | 종성 자음 미개방 |
| 아랍어 | p에 /b/, v에 /f/ | 모음군 회피 |

---

## 알고리즘 세부사항

### 난이도 점수 계산

`analyzeG2PDifficulty()` 함수는 기여도를 누적하여 0-1 난이도 점수를 계산합니다:

| 요소 | 기여도 | 근거 |
|--------|--------------|-----------|
| 예외 단어 일치 | +0.20 | 단어가 일반적인 규칙을 깨뜨림 |
| 묵음 문자 존재 | +0.15 | 예측 불가능한 발음 |
| 각 모음 조합 | +0.10 | 가변적인 발음 |
| 각 3+자음군 | +0.15 | 조음 난이도 |
| 3 초과 음절 | 음절당 +0.05 | 길이 복잡성 |
| 불규칙 강세 | +0.10 | 예측 불가능한 강조 |

점수는 최대 1.0으로 제한됩니다.

### 음절 수 세기 휴리스틱

`countSyllables()` 함수는 조정이 포함된 모음 계수 방식을 사용합니다:

1. 모음 그룹 수 세기 (`[aeiouy]+`)
2. 묵음 말미 "e"에 1 빼기 (자음 뒤에 올 때)
3. 음절적 "-le" 어미에 1 더하기 ("ble," "tle" 같은)
4. 음절적 "-ed" 어미에 1 더하기 ("t" 또는 "d" 뒤에)
5. 최소 1 음절 보장

**정확도**: 이 휴리스틱은 일반적인 영어 어휘에서 약 85% 정확도를 달성합니다. "fire" (억양에 따라 1 또는 2 음절) 같은 엣지 케이스는 더 단순한 수로 기본 처리됩니다.

---

## 변경 이력

### 2026-01-04 - 초기 문서화
- **변경 사항**: G2P 모듈에 대한 내러티브 문서 생성
- **이유**: 팀이 발음 분석 시스템을 이해할 수 있도록
- **영향**: 유지보수성 및 온보딩 개선

### 모듈 생성 - 핵심 구현
- **변경 사항**: 규칙 데이터베이스, L1 간섭 패턴, 벡터 생성을 포함한 완전한 G2P 분석 구현
- **이유**: LOGOS는 과제 보정 및 개인화된 오류 예측을 위한 발음 난이도 추정이 필요함
- **영향**: LanguageObjectVector의 음운적 차원과 L1 특정 발음 훈련 가능
