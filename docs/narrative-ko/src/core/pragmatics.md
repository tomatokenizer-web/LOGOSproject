# 화용론 모듈

> **최종 업데이트**: 2026-01-05
> **코드 위치**: `src/core/pragmatics.ts`
> **상태**: 활성

---

## 맥락 및 목적

화용론 모듈은 언어 학습을 위한 **화용적 능력 분석**을 구현합니다. 화용론은 문법적으로 *무엇이* 옳은지뿐만 아니라 주어진 맥락에서 *무엇이 사회적으로 적절한지*를 지배하기 때문에 언어 학습의 "숨겨진 교육과정"이라고 불리기도 합니다.

**비즈니스 필요성**: 언어 학습자들은 문법이 기술적으로 맞더라도 원어민이 어색하거나 부적절하게 느끼는 화용적 오류를 자주 범합니다. 학습자가 교수에게 "Would you mind if I had some water?"가 맥락적으로 적절할 때 "Give me water" (문법적으로 맞음)라고 말할 수 있습니다. 이 모듈은 LOGOS가 이러한 미묘한 언어 사용의 사회적 차원을 탐지, 분석, 가르칠 수 있게 합니다.

**사용 시점**:
- 학습자가 생성한 텍스트가 의도한 사회적 맥락과 일치하는지 평가할 때
- 특정 레지스터 (공식적, 비공식적 등)에 맞아야 하는 콘텐츠 생성 시
- 요청, 사과, 불만 등의 화행이 문화적으로 적절한지 평가할 때
- 과제 매칭에 사용되는 z(w) 벡터의 **PRAG 점수** 계산 시
- 레지스터에 민감한 연습이 필요한 어휘 항목 결정 시

---

## 미시적 관점: 직접적 관계

### 의존성 (이 모듈이 필요로 하는 것)

이 모듈은 **순수**합니다 - 외부 의존성이 없습니다. 내장된 TypeScript/JavaScript 기능만 사용하여 모든 분석 알고리즘을 구현합니다. 이것은 설계상 의도된 것으로, 핵심 모듈이 부작용 없는 순수 함수여야 한다는 LOGOS 핵심 모듈 아키텍처 원칙을 따릅니다.

### 종속자 (이 모듈을 필요로 하는 것)

- **`src/core/task-matching.ts`**: 높은 레지스터 민감도를 가진 단어에 가장 적합한 과제 유형을 결정하기 위해 이 모듈의 **화용적 점수** (PRAG)를 z(w) 벡터의 일부로 사용합니다. 높은 화용적 점수를 가진 단어는 "레지스터 전환" 및 "맥락 적절한 사용" 연습에 매칭됩니다.

- **`src/core/state/component-object-state.ts`**: 다섯 가지 **LanguageComponent** 유형 중 하나로 화용론을 추적하며 (`'pragmatic'`), 화용적 능력에 대한 노출 이력과 인지 유도 지표를 관리합니다.

- **`src/core/register/register-calculator.ts`**: 더 상세한 레지스터 프로파일링을 제공하는 형제 모듈입니다. pragmatics.ts가 광범위한 화행과 공손성 분석을 처리하는 반면, register-calculator.ts는 세밀한 단어 수준 레지스터 적절성을 처리합니다.

- **`src/core/index.ts`**: 애플리케이션 전체에서 사용하기 위해 이 모듈의 함수를 내보냅니다 (아직 명시적으로 나열되지 않음 - 이것이 격차일 수 있음).

- **`src/main/ipc/claude.ipc.ts`**: AI 생성 콘텐츠 검증에 화용적 분석 사용 가능.

### 데이터 흐름

```
사용자 텍스트 입력
      |
      v
+---------------------+
| analyzeRegister()   | --> 레지스터 점수 (frozen, formal, consultative, casual, intimate)
+---------------------+
      |
      v
+---------------------+
| detectSpeechAct()   | --> 화행 범주 (assertive, directive, commissive 등)
+---------------------+
      |
      v
+---------------------+
| analyzePoliteness() | --> 공손 전략 (bald_on_record, negative_politeness 등)
+---------------------+
      |
      v
+-------------------------------+
| assessPragmaticAppropriateness() | --> 점수와 권장 사항을 포함한 전체 평가
+-------------------------------+
      |
      v
+-----------------------------+
| generatePragmaticProfile()  | --> 단어/구문에 대한 완전한 화용적 프로필
+-----------------------------+
```

---

## 거시적 관점: 시스템 통합

### 아키텍처 계층

이 모듈은 LOGOS 아키텍처의 **핵심 알고리즘 계층**에 위치합니다:

```
계층 1: 렌더러 (React UI)
    |
    v
계층 2: 메인 프로세스 (IPC 핸들러, 서비스)
    |
    v
계층 3: 핵심 알고리즘 <-- pragmatics.ts가 여기 있음
    |
    v
계층 4: 데이터베이스 (Prisma/SQLite)
```

핵심 계층의 특징:
- 부작용이나 I/O가 없는 **순수 함수**
- 외부 의존성이 없는 **자체 완결형 알고리즘**
- 결정론적으로 테스트할 수 있는 **무상태 연산**

### 전체적 영향

이 모듈은 LOGOS의 이론적 기반에 설명된 **의미-화용-담화 구성요소**의 일부입니다. 다음을 가능하게 합니다:

1. **사용 공간 확장**: LOGOS의 핵심 사명은 학습자의 "사용 공간" - 효과적으로 소통할 수 있는 맥락과 상황을 확장하는 것입니다. 화용적 능력은 전문적, 학술적, 사회적 맥락을 적절하게 탐색하는 데 필수적입니다.

2. **z(w) 벡터 계산**: LOGOS의 모든 단어는 여섯 가지 차원을 가진 z(w) 벡터를 가집니다: 빈도, 관계적 밀도, 도메인 관련성, 형태론적 복잡성, 음운적 난이도, 그리고 **화용적 민감도**. 이 모듈은 PRAG 차원을 계산합니다.

3. **과제 유형 선택**: 높은 화용적 점수를 가진 단어 (레지스터에 민감한 표현 "I was wondering if you might..." vs "Gimme that")는 맥락적 적절성을 연습하는 전문화된 과제에 매칭됩니다.

4. **콘텐츠 생성 검증**: 특정 도메인 (의료 SOAP 노트, 법적 계약, 학술 초록)을 위한 학습 콘텐츠 생성 시, 이 모듈은 레지스터가 대상 장르와 일치하는지 검증합니다.

5. **오류 분석**: 학습자가 화용적 오류를 범하면, 이 모듈은 *어떤 종류*의 오류 (레지스터 불일치, 공손성 위반, 화행 실패)인지 식별하고 대상화된 권장 사항을 제공합니다.

### 임계 경로 분석

**중요도 수준**: 높음

이 모듈은 중요한 시작 경로에 있지 않지만, 다음에 필수적입니다:
- 정확한 z(w) 벡터 계산 (과제 선택 품질에 영향)
- 도메인별 콘텐츠 적절성 (의료, 법률, 비즈니스 영어)
- 중급 이상 수준의 학습자 진행 (화용적 능력이 B2+ 학습자를 구별)

**실패 시**: 과제 선택이 화용적 지능을 잃어 레지스터에 민감한 어휘에 부적절한 연습 유형을 할당할 수 있습니다. 콘텐츠 생성이 문법적으로는 맞지만 대상 맥락에서 사회적으로 부적절한 텍스트를 생성할 수 있습니다.

---

## 기술적 개념 (쉬운 설명)

### 레지스터
**기술적**: 특정 맥락에 적합한 특정 언어적 특징 (어휘, 문법, 어조)을 특징으로 하는 사회적 상황에서의 사용에 의해 정의되는 언어 변이.

**쉬운 설명**: 언어의 "드레스 코드". 취업 면접에 수영복을 입거나 해변에 턱시도를 입지 않는 것처럼, 법적 문서에 "gonna"라고 하거나 친구에게 보내는 문자에 "notwithstanding the aforementioned"라고 하지 않습니다. 레지스터는 어떤 단어가 어떤 상황에 "맞는지" 아는 것입니다.

**다섯 가지 레지스터**:
| 레지스터 | 맥락 | 예시 |
|----------|---------|---------|
| Frozen (경직) | 법률 문서, 종교 텍스트 | "We the People hereby establish..." |
| Formal (공식) | 학술 논문, 전문 보고서 | "This study demonstrates that..." |
| Consultative (상담) | 의사-환자, 교사-학생 | "I'd recommend considering..." |
| Casual (비격식) | 친구, 동료 | "Yeah, sounds good to me" |
| Intimate (친밀) | 가족, 친한 친구 | "C'mon, you know what I mean" |

**사용 이유**: 비원어민 화자들은 맥락에 관계없이 하나의 레지스터로 기본 설정하는 경우가 많습니다. 학습자가 친구들에게 과도하게 공식적이거나 (차갑게 보임) 상사에게 너무 비격식적일 수 있습니다 (무례하게 보임). LOGOS는 적절한 레지스터 전환을 탐지하고 훈련해야 합니다.

### 화행 (Speech Acts)
**기술적**: 단순히 정보를 전달하는 것 이상으로 행동 (요청, 약속, 사과)을 수행하는 발화. 철학자 John Searle (1979)의 분류체계에 기반.

**쉬운 설명**: 문장이 문자 그대로의 의미 이상으로 하는 *일*. "It's cold in here" (여기 춥네요)는 진술 (단언적)일 수도 있고, 실제로는 창문을 닫아달라는 요청 (간접 지시적)일 수도 있습니다. "I'll be there at 5" (5시에 갈게요)는 예측이거나 약속일 수 있습니다 - 차이가 중요합니다.

**다섯 가지 범주**:
| 범주 | 하는 것 | 예시 |
|----------|--------------|----------|
| Assertive (단언적) | 사실 진술 | "The report is complete" |
| Directive (지시적) | 누군가가 무언가를 하게 함 | "Could you review this?" |
| Commissive (약속적) | 화자를 구속 | "I promise to finish by Friday" |
| Expressive (표현적) | 감정 표현 | "Thank you for your help" |
| Declarative (선언적) | 말함으로써 현실 변경 | "I now pronounce you..." |

**사용 이유**: 화행 인식은 *의도* 이해에 중요합니다. 학습자는 "I was wondering if you might..."가 호기심 표현이 아니라 요청임을 인식해야 합니다. 다른 문화는 같은 화행을 수행하는 데 다른 관례를 가집니다.

### 공손 전략 (Brown & Levinson의 프레임워크)
**기술적**: 사회적 상호작용에서 "체면" (모든 사람이 유지하고 싶어하는 공적 자아 이미지)을 관리하기 위한 체계적인 언어 전략.

**쉬운 설명**: 당신이 하는 모든 요청은 잠재적으로 누군가에게 성가십니다 - 당신의 이익을 위해 그들의 시간/에너지를 사용하라고 요청하는 것입니다. 공손 전략은 "충격을 완화하는" 다양한 방법입니다:

| 전략 | 접근 | 예시 |
|----------|----------|---------|
| Bald on-record (직접적) | 직접적, 완화 없음 | "Give me the report" |
| Positive politeness (긍정적 공손) | 우정에 호소 | "Hey buddy, could you grab that report?" |
| Negative politeness (부정적 공손) | 부담 인정 | "I'm so sorry to bother you, but if it's not too much trouble..." |
| Off-record (간접적) | 요청 대신 암시 | "I noticed the report wasn't on my desk" (암시: 거기에 놓아주세요) |
| Don't do FTA (회피) | 요청 자체를 피함 | 아무 말 안 하고 직접 함 |

**사용 이유**: 다른 맥락은 다른 공손 수준을 요구합니다. 친한 동료에게 소금 건네달라고? 직접적으로 괜찮습니다. CEO에게 급여 인상 요청? 광범위한 완화와 함께 부정적 공손. 이 모듈은 맥락에 대한 **예상 공손 수준**을 계산하고 불일치를 표시합니다.

### 체면 위협 행위 (FTAs)
**기술적**: 누군가의 긍정적 체면 (호감받고 싶은 욕구)이나 부정적 체면 (자율성과 강요로부터의 자유에 대한 욕구)을 본질적으로 위협하는 행동.

**쉬운 설명**: 어떤 것들은 그냥 말하기 불편합니다. 부탁을 하면 누군가의 시간을 침해합니다 (부정적 체면 위협). 누군가의 작업을 비판하면 자아 이미지에 도전합니다 (긍정적 체면 위협). 사과하면 잘못을 인정합니다 (자신의 긍정적 체면 위협).

**네 가지 방향**:
- 화자의 긍정적 체면: "I was wrong" (오류 인정)
- 화자의 부정적 체면: "I'd love to help" (의무 수락)
- 청자의 긍정적 체면: "This isn't your best work" (비판)
- 청자의 부정적 체면: "Can you stay late?" (부담)

**사용 이유**: 학습자는 일부 화행이 본질적으로 "위험"하고 더 신중한 언어적 포장이 필요하다는 것을 이해해야 합니다. 거절이나 불만은 감사보다 더 많은 공손을 요구합니다.

### 문화적 맥락 민감도
**기술적**: 화용적 규범이 문화 집단에 따라 크게 다르며, 수용 가능한 레지스터, 직접성, 공손 관례에 영향을 미친다는 인식.

**쉬운 설명**: 뉴욕에서 공손한 것이 도쿄에서는 무례할 수 있습니다. 미국 영어는 더 직접적인 의사소통 경향이 있고; 일본어는 더 간접적인 암시와 존경 경향이 있습니다. 동아시아 비즈니스 맥락에서 "직접적" 스타일을 사용하면 문법이 완벽해도 무례하게 인식될 수 있습니다.

**사용 이유**: LOGOS는 다양한 L1 배경에서 다양한 L2 맥락으로 들어가는 학습자들에게 서비스합니다. 런던을 위해 영어를 배우는 일본 비즈니스맨은 캘리포니아를 위해 영어를 배우는 독일 엔지니어와 다른 화용적 훈련이 필요합니다. 이 모듈은 잠재적인 문화적 불일치를 표시합니다.

---

## 알고리즘 세부사항

### 레지스터 분석

`analyzeRegister()` 함수는 **표지 기반 점수 시스템**을 사용합니다:

1. **어휘 표지**: 각 레지스터는 특징적인 단어를 가집니다 (frozen: "hereby", "whereas"; casual: "gonna", "stuff"). 이러한 표지를 찾으면 레지스터 점수가 증가합니다.

2. **축약형 탐지**: 축약형 (don't, can't, I'm)은 frozen/formal 레지스터에서 드물지만 casual/intimate 레지스터에서 일반적입니다.

3. **수동태 빈도**: 더 높은 수동태 사용은 frozen/formal 레지스터 (학술 글쓰기, 법률 문서)와 상관관계가 있습니다.

4. **1인칭 대명사 밀도**: 높은 1인칭 사용은 casual/intimate 레지스터와 상관관계가 있고; 낮은 사용은 formal/frozen과 상관관계가 있습니다.

점수는 지배적인 레지스터가 점수 1.0을 얻고 다른 것들은 비례적으로 낮아지도록 정규화됩니다.

### 화행 탐지

`detectSpeechAct()` 함수는 알려진 화행 공식에 대한 **패턴 매칭**을 사용합니다:

- 요청: "Could you...", "Would you mind...", "I was wondering if..."
- 사과: "I'm sorry", "I apologize", "Forgive me"
- 약속: "I promise", "I will", "You have my word"

이것은 휴리스틱 접근입니다. 프로덕션 시스템은 머신러닝 분류기를 사용할 수 있지만, 패턴 기반 접근은 교육적 피드백에 적합한 해석 가능한 결과를 제공합니다.

### 화용적 난이도 계산

`calculatePragmaticDifficulty()` 함수는 단어/표현을 화용적으로 올바르게 사용하기가 얼마나 어려운지 추정합니다:

- **낮은 레지스터 유연성** = 더 어려움 (특정 맥락에서만 사용되어야 함)
- **높은 문화적 민감도** = 더 어려움 (문화적 맥락에 따라 다름)
- **체면 위협 화행** (거절, 불만) = 더 어려움
- **간접적 공손 전략** (간접적 암시) = 더 어려움

이 난이도 점수는 z(w) 벡터의 PRAG 차원에 반영되어 과제 선택에 영향을 미칩니다.

---

## 학술적 기반

이 모듈은 다음의 개념을 구현합니다:

- **Brown, P. & Levinson, S.C. (1987)**. *Politeness: Some Universals in Language Usage*. 공손 이론과 체면 위협 행위에 대한 기초 텍스트.

- **Bardovi-Harlig, K. (2013)**. *Developing L2 Pragmatics*. Language Learning. 제2언어 학습자가 화용적 능력을 발달시키는 방법에 대한 연구.

- **Kasper, G. & Rose, K.R. (2002)**. *Pragmatic Development in a Second Language*. L2 화용적 습득에 대한 주요 저작.

- **Taguchi, N. (2015)**. *Instructed pragmatics at a glance*. Language Teaching. 화용론 효과적 교육에 대한 현대 연구.

- **Searle, J. (1979)**. *Expression and Meaning: Studies in the Theory of Speech Acts*. 이 모듈에서 사용되는 화행 범주의 분류체계.

- **Biber, D. (1988)**. *Variation across Speech and Writing*. 5단계 레지스터 모델의 기반이 되는 레지스터 분석 프레임워크.

---

## 변경 이력

### 2026-01-05 - 문서 생성
- **변경 사항**: 화용론 모듈에 대한 내러티브 문서 생성
- **이유**: 모든 코드 파일에 대한 섀도우 문서 요구사항
- **영향**: 새 개발자를 위한 유지보수성 및 온보딩 개선

### 초기 구현
- **변경 사항**: 레지스터 탐지, 화행 분석, 공손 전략 평가, 화용적 난이도 계산을 포함한 포괄적인 화용론 분석 모듈 생성
- **이유**: LOGOS는 5개 구성요소 언어 모델을 위한 화용적 능력 분석이 필요함
- **영향**: 레지스터에 적합한 콘텐츠 생성과 화용적 오류 탐지 가능
