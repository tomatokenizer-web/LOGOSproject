# 기반 모듈 (Foundation)

> **최종 업데이트**: 2026-01-07
> **코드 위치**: `src/core/types.ts`, `src/core/index.ts`
> **상태**: 활성

---

## 네비게이션

- **상위**: [../INDEX.md](../INDEX.md)
- **다음**: [01-psychometric - 심리측정 모듈](../01-psychometric/)

---

## 개요

LOGOS 애플리케이션의 **기반 계층(Foundation Layer)**은 전체 시스템의 토대를 형성합니다. 이 계층은 두 가지 핵심 파일로 구성됩니다:

1. **types.ts**: 모든 도메인 타입 정의 (시스템의 공유 어휘)
2. **index.ts**: 배럴 내보내기를 통한 통합 API 진입점

이 기반 계층이 없으면 LOGOS의 다른 모든 모듈은 서로 통신할 수 없습니다.

---

## 맥락 및 목적

### 왜 이 모듈이 존재하는가?

언어 학습은 많은 상호 관련 개념이 있는 복잡한 도메인입니다:
- 능력 수준 (theta)
- 기억 스케줄링 (FSRS)
- 어휘 지표 (FRE)
- 과제 유형

신뢰할 수 있는 소프트웨어를 구축하려면 이러한 모든 개념에 **정확하고 일관된 정의**가 필요합니다. 기반 모듈은:

- 개발자들이 같은 것에 대해 다른 용어를 사용하는 것을 방지 ("점수" vs "능력" vs "theta")
- 전체 애플리케이션에서 타입 안전성을 보장
- 순수한 수학 함수를 Electron IPC, 데이터베이스 접근, UI 상태의 복잡한 현실과 분리

### 비즈니스 필요성

LOGOS는 정교한 심리측정, 언어학, 기억 과학 알고리즘을 구현합니다. 중앙 내보내기 포인트 없이는 개발자가:
- 15개 이상의 개별 파일에서 가져와야 함
- 내부 디렉토리 구조를 기억해야 함
- 코드베이스 전체에 흩어진 가져오기를 유지해야 함

배럴 내보내기는 알고리즘의 혼란을 **깔끔한 API 표면**으로 변환합니다.

### 사용 시점

- 메인 프로세스가 학습 우선순위를 계산해야 할 때
- UI가 숙달 진행 상황을 표시해야 할 때
- 학습자 응답을 처리하는 모든 IPC 핸들러
- 복습을 예약하거나 항목을 선택하는 모든 서비스
- 본질적으로: **계산 로직이 필요한 `/src/core` 외부의 모든 코드**

---

## 아키텍처 계층

기반 모듈은 **계층 0 (Foundation)**에 위치합니다 - 의존성이 없고 모든 것이 이것에 의존합니다:

```
+------------------------------------------------------------+
| 계층 3: 렌더러 (React 컴포넌트)                              |
+------------------------------------------------------------+
                            |
                            v
+------------------------------------------------------------+
| 계층 2: IPC 브릿지 (contracts.ts, *.ipc.ts)                |
+------------------------------------------------------------+
                            |
                            v
+------------------------------------------------------------+
| 계층 1: 서비스 & 메인 프로세스                               |
+------------------------------------------------------------+
                            |
                            v
+------------------------------------------------------------+
| 계층 0: 핵심 타입 & 알고리즘                                 |  <-- 기반
|          의존성 없음, 모든 도메인 타입 정의                    |
+------------------------------------------------------------+
```

---

## 코드 의존성 관계도

### 전체 의존성 구조

```
                            +-----------------+
                            |   index.ts      |
                            | (배럴 내보내기)  |
                            +--------+--------+
                                     |
        +----------------------------+----------------------------+
        |                            |                            |
        v                            v                            v
+---------------+          +------------------+         +------------------+
|   types.ts    |          |  알고리즘 파일들   |         |    하위 모듈들    |
| (공유 타입)    |          |  (15개 파일)      |         |   (5개 모듈)      |
+---------------+          +------------------+         +------------------+
        |                            |                            |
        |      +----+----+----+------+                            |
        |      |    |    |    |      |                            |
        |      v    v    v    v      v                            v
        |   +----++----++---++-----++------+    +---------+----------+
        +-->|IRT ||FSRS||PMI||우선 ||병목  |    |content/ |  tasks/  |
            +----++----++---+|순위 ||탐지  |    +---------+----------+
                             +-----++------+    |grammar/ | state/   |
                                                +---------+----------+
                                                |       register/    |
                                                +--------------------+
```

### types.ts 의존성

**의존성 (Dependencies)**: 없음 - 기초 계층으로 TypeScript 내장 타입만 사용

**의존처 (Dependents)**:

| 모듈 | 사용하는 타입 |
|------|--------------|
| `src/core/irt.ts` | `ItemParameter`, `ThetaEstimate`, `ItemCalibrationResult` |
| `src/core/fsrs.ts` | `FSRSCard`, `FSRSParameters`, `MasteryState` |
| `src/core/pmi.ts` | `PMIResult`, `PMIPair`, `DifficultyMapping`, `TaskType` |
| `src/core/priority.ts` | `FREMetrics`, `PriorityCalculation`, `PriorityWeights` |
| `src/core/bottleneck.ts` | `BottleneckEvidence`, `BottleneckAnalysis`, `ComponentType` |
| `src/main/services/task-generation.service.ts` | `TaskSpec`, `TaskContent`, `Task` |
| `src/main/services/scoring-update.service.ts` | `MasteryState`, `MasteryResponse` |

### index.ts 데이터 흐름

```
외부 요청 (IPC/서비스)
         |
         v
    [index.ts] -----> 적절한 알고리즘 선택
         |
         +---> IRT 함수 (능력 추정)
         |           |
         |           v
         |      세타 추정값 반환
         |
         +---> FSRS 함수 (스케줄링)
         |           |
         |           v
         |      다음 복습 날짜 반환
         |
         +---> 우선순위 함수 (큐 정렬)
         |           |
         |           v
         |      정렬된 학습 큐 반환
         |
         +---> 병목 함수 (진단)
                     |
                     v
                개입 권장 사항 반환
```

---

## 타입 도메인 구성

기반 모듈은 10개의 논리적 타입 도메인을 정의합니다:

### 1. IRT 타입 (문항반응이론)

**목적**: 학습자 능력과 문항 난이도의 심리측정 모델링을 가능하게 함.

| 타입 | 설명 |
|------|------|
| `IRTModel` | 사용할 통계 모델 ('1PL', '2PL', '3PL') |
| `ItemParameter` | 학습하기 얼마나 어려운지에 영향을 미치는 어휘 항목의 속성 |
| `ThetaEstimate` | 학습자가 얼마나 능숙한지의 측정 (신뢰 구간 포함) |
| `IRTResponse` | 학습자가 항목을 맞았는지 틀렸는지의 기록 |

**핵심 통찰**: Theta(능력)와 난이도는 같은 척도에 있습니다. theta가 0이면 평균 능력; 난이도가 0이면 평균 난이도. theta가 난이도와 같을 때 학습자는 **50% 성공 확률**을 가집니다.

### 2. PMI 타입 (점별 상호정보량)

**목적**: 자연어에서 단어들이 얼마나 강하게 연관되는지 측정.

| 타입 | 설명 |
|------|------|
| `PMIResult` | 두 단어 간 측정된 연관 강도 |
| `PMIPair` | 분석할 두 단어 |
| `CorpusStatistics` | 텍스트 모음에서의 단어 빈도에 대한 배경 데이터 |

**핵심 통찰**: 높은 PMI는 단어들이 우연보다 더 자주 함께 나타남을 의미합니다. "커피"와 "컵"은 높은 PMI를 가집니다.

### 3. FSRS 타입 (간격반복)

**목적**: 장기 기억을 최대화하기 위해 최적의 간격으로 복습을 스케줄링.

| 타입 | 설명 |
|------|------|
| `FSRSCard` | 항목의 기억 상태 (얼마나 잘 배웠는지, 얼마나 안정적인지) |
| `FSRSRating` | 학습자의 자기 평가 (1=잊음, 4=쉬움) |
| `FSRSParameters` | 알고리즘 튜닝 설정 |
| `FSRSScheduleResult` | 다음에 언제 복습할지 |

**핵심 통찰**: 안정성(S)은 잊을 때까지의 일수입니다. 알고리즘은 **90% 기억 유지**를 목표로 복습 타이밍을 최적화합니다.

### 4. 숙달 타입 (Mastery)

**목적**: 학습 단계를 통한 진행 추적.

```
미지 (0) -> 인식 (1) -> 회상 (2) -> 산출 (3) -> 자동화 (4)
```

| 타입 | 설명 |
|------|------|
| `MasteryStage` | 현재 기술 수준 (0-4) |
| `MasteryState` | 항목에 대한 완전한 학습 기록 |
| `ScaffoldingGap` | 힌트 있을 때와 없을 때의 성능 차이 |
| `StageThresholds` | 다음 단계로 진급하기 위한 요구사항 |

### 5. 과제 타입 (Task)

**목적**: LOGOS가 생성할 수 있는 학습 연습의 종류를 정의.

| 타입 | 설명 |
|------|------|
| `TaskType` | 연습의 종류 (인식, 회상, 산출 등) |
| `TaskFormat` | 연습의 제시 방식 (MCQ, 빈칸 채우기, 자유 응답) |
| `TaskSpec` | 생성할 연습에 대한 요청 |
| `TaskContent` | 실제 연습 내용 (프롬프트, 답, 힌트) |

**핵심 통찰**: 과제 유형 + 형식 + 양식이 결합하여 다양한 연습을 만듭니다.
- "인식 + MCQ + 시각적" = 읽기 객관식
- "산출 + 자유 응답 + 청각적" = 듣고 말하기

### 6. 우선순위 타입 (FRE Metrics)

**목적**: 빈도, 관계, 맥락을 기반으로 다음에 무엇을 공부할지 결정.

| 타입 | 설명 |
|------|------|
| `FREMetrics` | 어휘에 대한 3차원 중요도 점수 |
| `PriorityCalculation` | 하나의 항목에 대한 완전한 순위 데이터 |
| `PriorityWeights` | 계산에서 F, R, E의 균형을 맞추는 방법 |

**핵심 통찰**: FRE는:
- **F**requency (빈도): 실제 언어에서 얼마나 자주 나타나는지
- **R**elational density (관계 밀도): 다른 단어들과 얼마나 연결되는지
- **E**fficiency (맥락적 기여): 이해에 얼마나 많은 의미를 더하는지

높은 FRE 단어를 먼저 학습합니다.

### 7. 병목 타입 (Bottleneck)

**목적**: 진행을 막는 언어 구성요소 탐지.

| 타입 | 설명 |
|------|------|
| `ComponentType` | 다섯 가지 언어 수준 (PHON, MORPH, LEX, SYNT, PRAG) |
| `BottleneckEvidence` | 한 수준에서의 오류 패턴 |
| `BottleneckAnalysis` | 오류 원인 진단 |
| `CascadeAnalysis` | 한 수준의 오류가 상위 수준의 오류를 어떻게 유발하는지 |

**핵심 통찰 - 계단식 순서**:
```
음운(PHON) -> 형태(MORPH) -> 어휘(LEX) -> 통사(SYNT) -> 화용(PRAG)
```
하위 수준의 오류가 상위 수준에서 명백한 오류를 유발합니다. 증상이 아닌 **근본 원인**을 수정해야 합니다.

### 8. 언어 객체 타입 (Language Object)

**목적**: 학습될 수 있는 모든 것을 표현.

| 타입 | 설명 |
|------|------|
| `LanguageObjectType` | 분류 (LEX=단어, MWE=구, MORPH=패턴 등) |
| `LanguageObject` | 모든 지표를 포함한 학습 가능 항목의 완전한 기록 |

### 9. 세션 타입 (Session)

**목적**: 처음부터 끝까지 학습 세션을 추적.

| 타입 | 설명 |
|------|------|
| `SessionMode` | 세션의 목적 (새로운 것 학습, 훈련, 평가) |
| `SessionConfig` | 세션을 위한 설정 (지속 시간, 집중 영역) |
| `SessionState` | 세션 중 실시간 추적 |
| `SessionSummary` | 세션 후 분석 |

### 10. 유틸리티 타입 (Utility)

**목적**: 전체적으로 사용되는 범용 헬퍼.

| 타입 | 설명 |
|------|------|
| `Result<T, E>` | 데이터와 함께 성공하거나 오류와 함께 실패 |
| `PaginationParams` | 페이지 단위로 데이터 가져오기 |
| `DateRange` | 필터링을 위한 시간 창 |

---

## 12개 알고리즘 영역

배럴 내보내기(index.ts)는 이론적 기반을 반영하는 일관된 영역으로 알고리즘을 구성합니다:

| 영역 | 설명 | 핵심 함수 |
|------|------|----------|
| **IRT** | 통계적 척도로 학습자 능력 모델링 | `probability2PL`, `estimateThetaEAP` |
| **FSRS** | 망각 곡선 예측, 최적 복습 시기 예약 | `createFSRSCard`, `updateFSRS` |
| **PMI** | 단어 연관성 측정 | `computePMI`, `computeNPMI` |
| **우선순위** | 빈도, 관계, 맥락을 학습 순서로 결합 | `calculatePriority`, `rankByPriority` |
| **병목** | 언어 구성요소를 통한 오류 연쇄 추적 | `analyzeBottleneck`, `identifyRootCause` |
| **형태론** | 단어를 의미 있는 단위로 분해 | `analyzeMorphology` |
| **G2P** | 철자를 발음에 매핑 | `graphemeToPhoneme` |
| **통사론** | 문장 복잡성 분석 | `parseSentence`, `calculateSyntacticComplexity` |
| **응답 타이밍** | 응답 속도 패턴을 통한 자동화 측정 | `analyzeResponseTiming` |
| **과제 매칭** | 학습자 상태에 적합한 연습 유형 선택 | `matchTaskToLearner` |
| **전이** | 모국어로부터의 긍정적/부정적 전이 예측 | `predictTransfer` |
| **단계 임계값** | 학습 단계 진행 기준 정의 | `checkStageAdvancement` |

---

## 기술 개념 (쉬운 설명)

### Theta (능력 매개변수)

**기술적**: 문항반응이론에서 측정되는 구인에 대한 사람의 기저 능력을 나타내는 잠재 특성 매개변수로, 일반적으로 -3에서 +3 범위의 로짓 척도로 표현.

**쉬운 설명**: theta를 **숨겨진 기술 수준**처럼 생각하세요. 직접 볼 수는 없지만 수행을 보고 추정할 수 있습니다. 0은 평균, 양수는 평균 이상, 음수는 평균 이하입니다. 언어 기술을 위한 **타율** 같은 것입니다.

### 변별도 (Discrimination, a)

**기술적**: IRT 모델에서 능력이 문항 난이도에 접근할 때 성공 확률이 얼마나 빠르게 변하는지를 결정하는 기울기 매개변수.

**쉬운 설명**: 문항이 기술 차이에 얼마나 **"민감한"지**. 높은 변별도 문항은 잘하는 학습자와 어려워하는 학습자를 날카롭게 구분합니다.

### 안정성 (Stability, FSRS)

**기술적**: 성공적 회상 확률이 목표 기억 유지율(일반적으로 90%)과 같아지는 일 단위 간격.

**쉬운 설명**: **잊을 때까지의 일수**. 안정성이 30일이면 알고리즘은 약 한 달 동안 기억할 것으로 예측합니다. 높은 안정성 = 깊이 학습됨.

### 배럴 내보내기 패턴

**기술적**: 다른 모듈의 내보내기를 재내보내기하여 단일 가져오기 지점으로 집계하는 모듈.

**쉬운 설명**: **대기업의 안내 데스크**와 같습니다. 각 부서가 어느 층, 어느 사무실에 있는지 아는 대신, 안내 데스크에서 물어보면 연결해 줍니다.

### 순수 함수

**기술적**: 같은 입력에 대해 항상 같은 출력을 생성하고, 부작용이 없으며, 외부 상태에 의존하지 않는 함수.

**쉬운 설명**: **계산기**와 같습니다. 2+2를 누르면 항상 4를 얻습니다. 몇 시인지, 누가 사용하는지, 이전에 무슨 일이 있었는지 상관없습니다.

---

## 명명 규칙

`AGENT-MANIFEST.md`에 따라 이 모듈은 권위 있는 명명을 확립합니다:

| 올바른 용어 | 잘못된 대안 |
|-------------|-------------|
| `theta` | score, level, ability |
| `priority` | weight, importance |
| `irtDifficulty` | hardness |
| `frequency` | F |
| `relationalDensity` | R |
| `contextualContribution` | E |

---

## 사용 예시

### 기본 가져오기

```typescript
import {
  probability2PL,
  estimateThetaEAP,
  updateFSRS,
  calculatePriority
} from '@core';
```

### 타입 전용 가져오기

```typescript
import type {
  ItemParameter,
  ThetaEstimate,
  FSRSCard,
  MasteryState
} from '@core';
```

### 하위 모듈 기능

```typescript
import {
  ContentGenerator,
  createContentSpec,
  TRADITIONAL_TASK_TYPES,
  selectOptimalTaskType
} from '@core';
```

### 딥 가져오기 (트리 쉐이킹 최적화)

```typescript
// 최소 번들을 위해 특정 파일에서 직접 가져오기
import { probability2PL } from '@core/irt';
```

---

## 임계 경로 분석

**중요도 수준**: 매우 중요 (계층 0)

이것은 LOGOS에서 **가장 중요한 모듈**입니다. 서비스나 UI 구성요소와 달리, 핵심 알고리즘은 학습 시스템을 근본적으로 깨뜨리지 않고는 우회하거나 모킹할 수 없습니다.

### 실패 모드

| 실패 지점 | 영향 |
|-----------|------|
| types.ts 버그 | LOGOS의 모든 모듈이 오작동 |
| IRT 실패 | 능력 추정이 무작위, 적응적 난이도 깨짐 |
| FSRS 실패 | 복습 스케줄링이 임의적, 망각 곡선 무시 |
| 우선순위 실패 | 학습 큐가 정렬되지 않음, 비효율적 학습 |
| 병목 실패 | 오류 진단 불가능, 학습자가 막힘 |

### 복구 전략

순수 함수 아키텍처는 실패가 **결정론적이고 테스트 가능**함을 의미합니다. 각 알고리즘은 `src/core/__tests__/`에 해당 테스트가 있습니다. 알고리즘이 잘못된 결과를 생성하면 수정이 이 단일 내보내기 포인트를 통해 모든 곳에 자동으로 전파됩니다.

---

## 전체적 영향

이 모듈이 사라지면 전체 LOGOS 애플리케이션이 붕괴됩니다:

| 기능 | 사용되는 알고리즘 |
|------|-----------------|
| "다음에 무엇을 배워야 하나요?" | priority.ts, task-matching.ts |
| "이 단어를 얼마나 잘 알고 있나요?" | irt.ts, fsrs.ts, stage-thresholds.ts |
| "언제 이것을 복습해야 하나요?" | fsrs.ts, priority.ts |
| "왜 이 오류를 계속 범하나요?" | bottleneck.ts, transfer.ts |
| "이 단어가 배울 가치가 있나요?" | pmi.ts, priority.ts |
| "적절한 연습 생성" | content/, tasks/, grammar/ |
| "내 유창성 수준은?" | response-timing.ts, irt.ts |
| "내 수준에 맞는 콘텐츠" | irt.ts, task-matching.ts, register/ |

---

## 변경 이력

### 2026-01-07 - 통합 문서 생성
- **변경 사항**: core-foundation.md, types.md, index.md를 통합한 단일 문서 생성
- **이유**: 기반 모듈에 대한 전체적인 이해를 제공
- **영향**: 새 개발자가 핵심 모듈 구성을 한 곳에서 이해 가능

### 2026-01-06 - types.ts 문서화
- **변경 사항**: types.ts에 대한 섀도우 문서 생성
- **이유**: 타입 시스템 기초 문서화

### 2026-01-05 - index.ts 문서화
- **변경 사항**: 배럴 내보내기 아키텍처를 설명하는 내러티브 문서 추가
- **이유**: 유지보수성 향상을 위한 섀도우 문서 시스템 지원

---

## 네비게이션

- **상위**: [../INDEX.md](../INDEX.md)
- **다음**: [01-psychometric - 심리측정 모듈](../01-psychometric/)
